"""
Make vulnerability_scan cols nullable and timestamp default

Revision ID: 445566778899
Revises: 112233445566
Create Date: 2025-06-05 01:48:00.000000

"""
from alembic import op
import sqlalchemy as sa

# revision identifiers, used by Alembic.
revision = '445566778899'
down_revision = '112233445566'
branch_labels = None
depends_on = None


def upgrade():
    with op.batch_alter_table('vulnerability_scans') as batch:
        batch.alter_column('device_id', nullable=True)
        batch.alter_column('status', nullable=True)
        batch.alter_column('timestamp', server_default=sa.text('now()'), nullable=False)


def downgrade():
    with op.batch_alter_table('vulnerability_scans') as batch:
        batch.alter_column('timestamp', server_default=None, nullable=False)
        batch.alter_column('status', nullable=False)
        batch.alter_column('device_id', nullable=False)
