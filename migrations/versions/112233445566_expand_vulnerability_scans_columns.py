"""
Expand vulnerability_scans with detailed fields

Revision ID: 112233445566
Revises: abcdef123456
Create Date: 2025-06-05 01:44:00.000000

"""
from alembic import op
import sqlalchemy as sa

# revision identifiers, used by Alembic.
revision = '112233445566'
down_revision = 'abcdef123456'
branch_labels = None
depends_on = None


def upgrade():
    # Add detailed vulnerability fields
    op.add_column('vulnerability_scans', sa.Column('vulnerability_id', sa.String(length=100), nullable=True))
    op.add_column('vulnerability_scans', sa.Column('title', sa.String(length=255), nullable=True))
    op.add_column('vulnerability_scans', sa.Column('description', sa.Text(), nullable=True))
    op.add_column('vulnerability_scans', sa.Column('severity', sa.String(length=20), nullable=True))
    op.add_column('vulnerability_scans', sa.Column('cvss_score', sa.Float(), nullable=True))
    op.add_column('vulnerability_scans', sa.Column('affected_component', sa.String(length=255), nullable=True))
    op.add_column('vulnerability_scans', sa.Column('fix_available', sa.String(length=50), nullable=True))
    op.add_column('vulnerability_scans', sa.Column('remediation', sa.Text(), nullable=True))


def downgrade():
    # Remove detailed vulnerability fields
    op.drop_column('vulnerability_scans', 'remediation')
    op.drop_column('vulnerability_scans', 'fix_available')
    op.drop_column('vulnerability_scans', 'affected_component')
    op.drop_column('vulnerability_scans', 'cvss_score')
    op.drop_column('vulnerability_scans', 'severity')
    op.drop_column('vulnerability_scans', 'description')
    op.drop_column('vulnerability_scans', 'title')
    op.drop_column('vulnerability_scans', 'vulnerability_id')
